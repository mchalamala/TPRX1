import pandas as pd

input_file = "TPRX1_deseq.csv"

df = pd.read_csv(input_file)

df['padj'] = pd.to_numeric(df['padj'], errors='coerce')
df['log2FoldChange'] = pd.to_numeric(df['log2FoldChange'], errors='coerce')

df = df.dropna(subset=['padj', 'log2FoldChange'])

upregulated = df[(df['padj'] < 0.06) & (df['log2FoldChange'] > 2)]
downregulated = df[(df['padj'] < 0.06) & (df['log2FoldChange'] < -2)]

output_file = "filtered_genes.xlsx"
with pd.ExcelWriter(output_file) as writer:
    upregulated.to_excel(writer, sheet_name='Upregulated', index=False)
    downregulated.to_excel(writer, sheet_name='Downregulated', index=False)

print("Filtering complete. Results saved to", output_file)
